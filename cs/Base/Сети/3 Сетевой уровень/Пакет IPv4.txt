Заголовок пакета IPv4

Заголовок пакета IPv4 обычно весит 20 байт (или 160 бит) при отсутствии дополнительных опций. Это минимальный размер, который может увеличиваться до 60 байт (или 480 бит) в случае наличия опций. Размер заголовка определяется полем "размер заголовка" (IHL), которое указывает длину в 32-битных словах, где минимальное значение составляет 5 (что соответствует 20 байтам) и максимальное — 15 (60 байт)

	- Версия (4 бита). Содержит 4-битное двоичное значение, определяющее версию IP-пакета. Для пакетов IPv4 в этом поле всегда указано значение 0100 (4). Тогда как в поле IPv6 указано 0110 (6).

	- Размер заголовка (4 бита. Internet Header Length - IHL). Указывает значение длины заголовка, измеренное в 32-битовых словах. Обычно заголовок IP-пакета имеет длину в 20 байт (пять 32-битовых слов), но при увеличении объема служебной информации эта длина может быть увеличена. Наибольший заголовок занимает 60 октетов.

	- Дифференцированные сервисы (6 бит, Differentiated Services Code Point - DSCP) - это поле в заголовке IPv4, используемое для маркировки пакетов с целью управления качеством обслуживания в сетях. Оно позволяет классифицировать трафик и приоритизировать его, что особенно важно для чувствительных к задержкам приложений, таких как голосовая связь и потоковое видео. Механизм может применяться, например, для снижения задержки чувствительного сетевого трафика вроде голосовой связи и потокового мультимедиа, тогда как остальной трафик будет идти без приоритизации. Маршрутизаторы и компьютеры могут принимать во внимание приоритет пакета и обрабатывать более важные пакеты в первую очередь. DSCP использует 6-битное поле 8-битного IP-заголовка DS. Для IPv4 используется пространство устаревшего заголовка ToS, который разделён на поля DSCP и ECN. Заменяет старое поле Type of Service (ToS).

	- Длина пакета (16 бит, Total Length) - 16-битная полная длина пакета в байтах, включая заголовок и данные. Минимальный размер равен 20 байтам (заголовок без данных), максимальный - 65535 байт. Хосты должны поддерживать передачу пакетов размером до 576 байт, но современные реализации обычно поддерживают гораздо больший размер. Пакеты большего размера, чем поддерживает канал связи, фрагментируются.

	- Идентификатор (16 бит, Identification) - используется для распознавания пакетов, образовавшихся путем фрагментации исходного пакета. Все фрагменты должны иметь одинаковое значение этого поля. 

		При фрагментации каждый фрагмент получает одинаковый идентификатор, что предотвращает путаницу между фрагментами различных пакетов. Поле смещения фрагмента дополнительно указывает позицию каждого фрагмента в исходном пакете, что облегчает сборку. Поле может принимать значения от 0 до 65,535.

	- Флаги (3 бит) - поле используется для управления фрагментацией пакетов. Оно позволяет маршрутизатору и другим сетевым устройствам определять, как обрабатывать фрагменты данных. Основные функции этого поля включают:

		- Не фрагментировать (DF - Don't fragment) - указывает, что пакет не должен быть фрагментирован. Если пакет слишком велик для передачи через сеть с меньшим максимальным размером передаваемого блока (MTU), он будет отброшен.

		- Больше фрагментов (MF - More fragments) - указывает, что пакет является частью фрагментированного сообщения. Если этот бит установлен, это значит, что есть другие фрагменты, которые должны быть собраны для восстановления оригинального пакета.

		- Резервный бит - этот бит обычно не используется и зарезервирован для будущих нужд (равен нулю).